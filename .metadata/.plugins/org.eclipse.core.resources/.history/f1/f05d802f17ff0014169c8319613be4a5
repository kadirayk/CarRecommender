package database;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.SQLException;

import model.Car;

public class DatabaseHelper {

	public static final String DRIVER = "org.apache.derby.jdbc.EmbeddedDriver";
	public static final String JDBC_CREATE_URL = "jdbc:derby:carrecommenderdb;create=true";
	
	public void createDB() throws ClassNotFoundException, SQLException{
		Class.forName(DRIVER);
		Connection connection = DriverManager.getConnection(JDBC_CREATE_URL);
		connection.createStatement().execute("create table cars(title varchar(300),"
				+ " brand varchar(30),"
				+ " model varchar(30),"
				+ " modeldetail varchar(30),"
				+ " product_year INT,"
				+ " car_km INT,"
				+ " color varchar(30),"
				+ " price INT,"
				+ " city varchar(30),"
				+ " town varchar(30))");	
	}
	
	public void insertCarIntoDB(Car mCar) throws SQLException{
		
		Connection connection = DriverManager.getConnection(JDBC_CREATE_URL);
		connection.createStatement().execute("insert into cars values "
				+ "('"+ mCar.getTitle() + "',"
				+ " '" + mCar.getBrand() + "',"
				+ " '" + mCar.getModel() + "',"
				+ " '" + mCar.getModelDetail() + "',"
				+  mCar.getYear() + ","
				+ mCar.getKm() + ","
				+ " '" + mCar.getColor() + "',"
				+ mCar.getPrice() + ","
				+ " '" + mCar.getCity() + "',"
				+ " '" + mCar.getTown() +"')");
		
	}
	
}
